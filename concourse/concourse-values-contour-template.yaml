---
concourse:
  web:
    externalUrl: https://CONCOURSE_URL
    auth:
      mainTeam:
        localUser: "admin"
        oidc:
          group: platform-team
      oidc:
        displayName: Okta
        enabled: true
        groupsKey: groups
        issuer: https://OKTA_AUTH_SERVER_CN/oauth2/default
        scope: openid,profile,email,groups,offline_access
        skipSslValidation: false
    baseResourceTypeDefaults: |
      registry-image:
        registry_mirror:
          host: REGISTRY_URL

secrets:
  oidcClientId: OKTA_CONCOURSE_APP_CLIENT_ID
  oidcClientSecret: OKTA_CONCOURSE_APP_CLIENT_SECRET
  oidcCaCert: OKTA_AUTH_SERVER_CA_CERT
  localUsers: "admin:KeepItSimple1!"
web:
  ingress:
    enabled: true
    annotations:
      kubernetes.io/ingress.class: "contour"
      cert-manager.io/cluster-issuer: "letsencrypt-contour-cluster-issuer"
      projectcontour.io/websocket-routes: "/"
    hosts:
      - CONCOURSE_URL
    tls:
    - hosts:
      - CONCOURSE_URL
      secretName: concourse-cert
  # Toleration needed for tainted node
  tolerations:
  - key: "type"
    operator: "Equal"
    value: "concourse"
    effect: "NoSchedule"
  nodeSelector:
    type: "concourse"
# Toleration needed for tainted node
worker:
  tolerations:
  - key: "type"
    operator: "Equal"
    value: "concourse"
    effect: "NoSchedule"
  nodeSelector:
    type: "concourse"

persistence:
  worker:
    size: 50Gi
